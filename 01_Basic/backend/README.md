# 01 Basic / backend

## シンプルなチャットAPIの実装

---

### はじめに 🌟
この実装ステップでは、シンプルなチャットAPIの基本的な実装を行います。  
FastAPIとLangChainを使用して、単一の質問に回答するAPIを構築します。

### 目標 🎯
- FastAPIを使用したバックエンドAPIの構築
- LangChainを用いたAIモデルとの連携
- 基本的なチャットAPIの動作確認

### 開発ステップ 🚀

1. 開発環境のセットアップ 🛠️  
2. 実装 💻  
3. テスト 🧪

---

### 1. 開発環境のセットアップ 🛠️

※ 注意: [事前準備](/SETUP.md) を完了させてから、以下のステップを進めてください。   

---

#### 1. VSCodeでプロジェクトを開く ⛹️‍♂️
`01_Basic`フォルダの`backend`フォルダをドラッグドロップをして、VSCodeで開きます。

---

#### 2. 仮想環境の作成 🔮
1. VSCode 画面上部のメニューから 表示 -> ターミナル ( View -> Terminal ) を選択してターミナルを表示します。
2. ターミナルで次のコマンドを入力して仮想環境を構築します。
```bash
python -m venv venv
```
このコマンドを実行すると、現在のフォルダに venv という名前のフォルダが作成されます。  

##### 注意事項 🚨
- 仮想環境（venvフォルダ）はGitリポジトリにコミットしないのが一般的です。  
仮想環境をコミットするとリポジトリの容量が大きく増加します。  
リポジトリの容量が大きくなるとサイズ制限やタイムアウトに起因する問題が発生するリスクが高まります。

- .gitignore ファイルを使用して、仮想環境を追跡対象から除外することをおすすめします。  
本リポジトリでも、.gitignoreファイルでvenvフォルダを除外しています。

---

#### 3. 仮想環境の有効化 🪄
仮想環境を有効化します：
- Windowsの場合：
    ```bash
    venv\Scripts\activate
    ```
- macOS/Linuxの場合：
    ```bash
    source venv/bin/activate
    ```

---

#### 4. 必要なライブラリのインストール 📚
仮想環境が有効になっていることを確認し、  
ターミナルで次のコマンドを入力して必要なライブラリをインストールします：
```bash
pip install -r requirements.txt
```

---

#### 5. OpenAI APIキーの設定 📄
本サンプルアプリケーションでは、OpenAI の API を使用します。  
OpenAI の API キーを安全に管理するために `.env` ファイルを使用します。  
以下の手順で `.env` ファイルに OpenAI の API キーを設定してください。

1. `.env` ファイルの作成  
`01_basic`フォルダに`.env`ファイルを作成します。

2. `.env` ファイルにAPIキーを追加  
    `.env`ファイルに、以下の形式で OpenAI API キー記述します：
    ```bash
    # .env
    OPENAI_API_KEY="sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
    ```

##### 注意事項 🚨
- `.env` ファイルには機密情報が含まれるため、Gitリポジトリにコミットしないように注意してください。

- `.gitignore` ファイルを使用して、`.env` ファイルを追跡対象から除外することをおすすめします。  
本リポジトリでは、.gitignoreファイルで.envファイルを除外しています。

---

### 2. 実装 💻  

次に、実装フェーズに進みます。  
01_Basic では、単一の質問に対して回答を生成するシンプルなチャットAPIを実装します。  
このプロジェクトでは、すでにサンプルコードが用意されており、基本的なチャットAPIが実装されています。  
以下のファイルを開いて、ファイル内のコメントを参考に、各部分の役割を理解しましょう。

[chat_server.py](./chat_server.py)

---

### 3. テスト 🧪

実装を確認したら、サーバーを起動して実際に動作をテストしましょう。  
01_Basic では、単一の質問に対する応答をテストします。

1. サーバーの起動  
ターミナルで以下のコマンドを実行し、サーバーを起動します:  
    ```bash
    python chat_server.py
    ```

2. Swagger UIへのアクセス  
サーバーが起動したら、ブラウザで以下のURLにアクセスしてSwagger UIを開きます:  
    ```
    http://localhost:9000/docs
    ```

3. APIのテスト  
    1. Swagger UI上で /chat エンドポイントを選択し、「Try it out」ボタンをクリックします。
    2. リクエストボディに適当な質問を入力し、「Execute」ボタンをクリックします。
    3. レスポンスを確認し、適切な応答が返ってくることを確認します。

---

これで、バックエンドの実装とテストが完了です。  
次は、フロントエンドの開発に進みましょう。  
[チャットフロントエンドの実装](../frontend/README.md)