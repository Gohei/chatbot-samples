# 03 RAG: 外部知識を活用したチャットボット 📚🤖

## はじめに 🌟
この実装ステップでは、02_Historyで作成した会話履歴機能付きチャットボットに、  
外部知識を活用する機能（RAG: Retrieval-Augmented Generation）を追加します。  
これにより、チャットボットは与えられた情報源に基づいて、より正確で詳細な応答ができるようになります。

## システムの動作フロー 🏄‍♂️
1. ユーザーがフロントエンドでメッセージを入力
2. フロントエンドが`session_id`とともにバックエンドAPIにリクエストを送信
3. バックエンドがリクエストを受信し、ベクトルストアから関連情報を検索
4. 検索結果と会話履歴を考慮してAIモデルが応答を生成
5. 生成された応答をバックエンドからフロントエンドに返信
6. フロントエンドが応答をユーザーに表示

## 開発ステップ 🏗️

### 1. バックエンド拡張
FastAPIで構築したチャットボットのAPIサーバーにRAG機能を追加します。  
LangChainを通じてベクトルストアと連携し、関連情報の検索と回答生成を実装します。  
ベクトルストアの作成方法を含む詳細な手順は、[バックエンドの実装ガイド](backend/README.md)を参照してください。

### 2. フロントエンド調整
この実装ステップではフロントエンドの変更は必要ありません。  
既存のChainlitインターフェースを使用して、拡張されたバックエンドと対話します。

## 主な変更点 📝

### ベクトルストア作成（create_vectorstore.py）:
1. テキストファイルの読み込みと分割
2. OpenAIEmbeddingsを使用したベクトル化
3. Chromaベクトルストアの作成と保存

### バックエンド（chat_server.py）:
1. 新規モジュールのインポート:
   - `Chroma`
   - `OpenAIEmbeddings`

2. プロンプトテンプレートの拡張:
   - `context`プレースホルダーを追加

3. ベクトルストアの統合:
   - Chromaベクトルストアの初期化
   - 質問に基づく関連情報の検索機能の追加

4. チャットエンドポイントの更新:
   - 質問に関連する情報を検索し、回答生成に利用

5. APIの更新:
   - アプリケーションタイトルを "Chat with RAG API" に変更

### フロントエンド（frontend_app.py）:
- 変更なし
